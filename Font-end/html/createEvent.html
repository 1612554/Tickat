<!doctype html>
<html lang="en">
  <head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="../css/style3.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous"> 
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/summernote@0.8.11/dist/summernote-bs4.min.css">

   
   <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
   
</head>
  <body>

      <div class="container">
          <div class="row">
            
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">           
              <nav>
                <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                  <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Event information</a>
                  <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Add new tickets</a>
                  <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">Confirm</a>
                </div>
              </nav>
              <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                      
                        <div class="card-body">
                            <div class="form-group">
                                <div>
                                    <label for="profile-img" class="btn title" style="cursor: pointer"><i class="far fa-images"></i> Choose image here:</label>
                                    <input name="file" id="profile-img" style="visibility:hidden;" type="file">
                                </div>
                                
                                <img src="https://www.riversports.com/rs/img/system/add_image_placeholder.png" id="profile-img-tag" style="width: 100%; height: 500px;"/>
                            </div>
                            <div class="form-group">
                              <label class="title"><i class="fas fa-edit"></i> Event name:</label>
                              <input type="text"
                                class="form-control" name="" id="" aria-describedby="helpId" placeholder="">
                            </div>
                          
                            
                            <label  class="title"><i class="fas fa-clock" aria-hidden="true"></i> Datetime</label>
                            <input id="date" data-date-format="DD-MM-YYYY HH:mm:ss"  width="312px" />

                            <div class="form-group mt-20">
                              <label  class="title"><i class="fas fa-map-marker"></i> Address:</label>
                              <input type="text"
                                class="form-control" name="" id="" aria-describedby="helpId" placeholder="">
                            </div>

                            <label  class="title"><i class="fas fa-flag"></i> Organization:</label>
                            <div class="input-group">
                                <select class="custom-select" id="inputGroupSelect04" aria-label="Example select with button addon" style=" margin-right: 5%">
                                   <option selected>Choose...</option>
                                    <option value="1">One</option>
                                    <option value="2">Two</option>
                                    <option value="3">Three</option>
                                </select>

                                <button type="button" class="btn btn-success" > <i class="fas fa-plus-circle"></i> Add an organization</button>
                            </div>

                            <label  class="title mt-20"><i class="fas fa-align-justify"></i> Category:</label>
                            <div class="input-group">
                                <select class="custom-select" id="inputGroupSelect04" aria-label="Example select with button addon" style=" margin-right: 5%">
                                   <option selected>Choose...</option>
                                    <option value="1">One</option>
                                    <option value="2">Two</option>
                                    <option value="3">Three</option>
                                </select>

                                <button type="button" class="btn btn-success" > <i class="fas fa-plus-circle"></i> Add a category</button>
                            </div>

                            <label  class="title mt-20"><i class="fas fa-info-circle"></i> Description:</label>
                            <textarea name="mailEditor" id="txtEditor"></textarea>

                        </div>
                      
                </div>
                <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div class="card-body">
                        <div class="tickets">
                          
                          </div>
                          <div id="editor">
                             <div class="card">
                                 <div class="card-body">
                                     <div class="form-group">
                                     <select class="form-control" name="" id="type">
                                       <option value="-1">Type of ticket</option>
                                       <option value="1">VIP</option>
                                       <option value="2">Free</option>
                                       <option value="3">Normal</option>
                                     </select>
                                   </div>

                                 
                                   <div class="form-inline">
                                     <input type="number" min="0" class="form-control price" id="price" aria-describedby="helpId" placeholder="Price">
                                     <input type="number" min="0" class="form-control amount" id="amount" aria-describedby="helpId" placeholder="Amount">
                                   </div>

                                   <div class="form-group">
                                     <label for="">Description</label>
                                     <textarea class="form-control" id="description" rows="3" placeholder="Description here....."></textarea>
                                   </div>
                                 </div>
                             </div>
                          </div>

                          <button type="button" class="btn btn-primary btn-save" style="float: right; margin:40px 10px; display: none">Save</button>
                          <button type="button" class="btn btn-primary btn-editor" style="float: right; margin:40px auto">Add new ticket</button>
                    </div>
                       
                </div>
                <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
                  Et et consectet
                </div>

              </div>
            
            </div>
          </div>
    </div>
  </div>
</div>

        <!-- <div class="container mt-50">
                <div id="createevent">
                        <div class="card">
                          <div class="card-header" id="headingOne">
                            <h5 class="mb-0">
                              <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                1. Event information
                              </button>
                            </h5>
                          </div>
                      
                          <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#createevent">
                            <div class="card-body">
                                <div class="form-group">
                                    <div>
                                        <label for="profile-img" class="btn title" style="cursor: pointer"><i class="far fa-images"></i> Choose image here:</label>
                                        <input name="file" id="profile-img" style="visibility:hidden;" type="file">
                                    </div>
                                    
                                    <img src="https://www.riversports.com/rs/img/system/add_image_placeholder.png" id="profile-img-tag" style="width: 100%; height: 500px;"/>
                                </div>
                                <div class="form-group">
                                  <label class="title"><i class="fas fa-edit"></i> Event name:</label>
                                  <input type="text"
                                    class="form-control" name="" id="" aria-describedby="helpId" placeholder="">
                                </div>
                              
                                
                                <label  class="title"><i class="fas fa-clock" aria-hidden="true"></i> Datetime</label>
                                <input id="date" data-date-format="DD-MM-YYYY HH:mm:ss"  width="312px" />

                                <div class="form-group mt-20">
                                  <label  class="title"><i class="fas fa-map-marker"></i> Address:</label>
                                  <input type="text"
                                    class="form-control" name="" id="" aria-describedby="helpId" placeholder="">
                                </div>

                                <label  class="title"><i class="fas fa-flag"></i> Organization:</label>
                                <div class="input-group">
                                    <select class="custom-select" id="inputGroupSelect04" aria-label="Example select with button addon" style=" margin-right: 5%">
                                       <option selected>Choose...</option>
                                        <option value="1">One</option>
                                        <option value="2">Two</option>
                                        <option value="3">Three</option>
                                    </select>
   
                                    <button type="button" class="btn btn-success" > <i class="fas fa-plus-circle"></i> Add an organization</button>
                                </div>

                                <label  class="title mt-20"><i class="fas fa-align-justify"></i> Category:</label>
                                <div class="input-group">
                                    <select class="custom-select" id="inputGroupSelect04" aria-label="Example select with button addon" style=" margin-right: 5%">
                                       <option selected>Choose...</option>
                                        <option value="1">One</option>
                                        <option value="2">Two</option>
                                        <option value="3">Three</option>
                                    </select>
   
                                    <button type="button" class="btn btn-success" > <i class="fas fa-plus-circle"></i> Add a category</button>
                                </div>

                                <label  class="title mt-20"><i class="fas fa-info-circle"></i> Description:</label>
                                <textarea name="mailEditor" id="txtEditor"></textarea>

                            </div>
                          </div>
                        </div>
                        <div class="card">
                          <div class="card-header" id="headingTwo">
                            <h5 class="mb-0">
                              <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                2. Tickets
                              </button>
                            </h5>
                          </div>
                          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#createevent">
                                <div class="card-body">
                                    <div class="tickets">
                                      
                                      </div>
                                      <div id="editor">
                                         <div class="card">
                                             <div class="card-body">
                                                 <div class="form-group">
                                                 <select class="form-control" name="" id="type">
                                                   <option value="-1">Type of ticket</option>
                                                   <option value="1">VIP</option>
                                                   <option value="2">Free</option>
                                                   <option value="3">Normal</option>
                                                 </select>
                                               </div>
   
                                             
                                               <div class="form-inline">
                                                 <input type="number" min="0" class="form-control price" id="price" aria-describedby="helpId" placeholder="Price">
                                                 <input type="number" min="0" class="form-control amount" id="amount" aria-describedby="helpId" placeholder="Amount">
                                               </div>
   
                                               <div class="form-group">
                                                 <label for="">Description</label>
                                                 <textarea class="form-control" id="description" rows="3" placeholder="Description here....."></textarea>
                                               </div>
                                             </div>
                                         </div>
                                      </div>
   
                                      <button type="button" class="btn btn-primary btn-save" style="float: right; margin:40px 10px; display: none">Save</button>
                                      <button type="button" class="btn btn-primary btn-editor" style="float: right; margin:40px auto">Add new ticket</button>
                                   </div>
                            </div>
                          </div>
                        </div>
                        
             </div>
             <button id="submit">Submit</button>
        </div> -->
    <!-- Optional JavaScript -->
   
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bs4-summernote@0.8.10/dist/summernote-bs4.min.js"></script>

    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<script>
  $('#date').datetimepicker({  
    footer: true, 
    modal: true ,
    format: 'yyyy-mm-dd hh:mm:ss',
    "setDate": new Date(),
    use24hours: true
  });

$(document).ready(function() {
    $('textarea').summernote({
        height: 300,   //set editable area's height
    });
});

function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        
        reader.onload = function (e) {
            $('#profile-img-tag').attr('src', e.target.result);
        }
        reader.readAsDataURL(input.files[0]);
    }
}
$("#profile-img").change(function(){
    readURL(this);
});

  $("#profile-img-tag").click(()=>{
    $("#profile-img").click();
});


</script>


<script>
    $('.btn-editor').click(()=>{
    if($("#editor").is(":visible")){
      $("#editor").hide();
      $(".btn-save").hide();
      $('.btn-editor').html("Add new event");
    }else{
      $("#editor").show();
      $(".btn-save").show();
      $('.btn-editor').html("Close");
    }
  });

  $(".btn-save").click(()=>{
      var type_id = $("#type option:selected").val();
      var type = $("#type option:selected").text();
      var price = parseInt($("#price").val()) || 0;
      var description = $("#description").val();
      var amount = $("#amount").val();

      if(type_id==-1){
        alert("Please choose type of ticket!");
      }else if(typeof price == 'undefined'){
        alert("Price is required!");
      }else if(description==""){
        alert("Description is required!");
      }else if(typeof amount == 'undefined'|| amount<0){
        alert("Amount is required!");
      }else{
        var obj = JSON.stringify({type_id:type_id,price:price,amount:amount,description:description});

        $(".tickets").append(
          `
          <div class="card" data-ticket='${obj}'>
              <div class="card-body">
                  <span class="card-title">${type}</span>
                  <span class="card-subtitle mb-2 text-muted">Price: ${price}</span>
                  <p class="card-text">Description: ${description}</p>
                  <p>Amount: ${amount}</p>
                  <button type="button" class="btn btn-danger delete">Delete</button>
              </div>
          </div>
          `
        );

        $(".delete").on('click', function() {
          $(this).parent().parent().remove();
        });

        resetForm();
        $('.btn-editor').click();
      }
      
  });

  function resetForm(){
    $("#type").val(-1);
    $("#price").val("");
    $("#amount").val("");
    $("#description").val("");
  }

  $(".btn-create").click(()=>{
    var tickets = [];
    $(".tickets .card").each(function (index, element) {
        var ticket = $(this).data("ticket");
        tickets.push(JSON.stringify(ticket));
    });
    
    /*var img = $("#profile-img").prop('files')[0];
    var name = $("#name").val();
    var date = $("#date").val();
    var address = $("#address").val();
    var description =  $("#txtEditor").val();
    var organization_id = $("#organization option:selected").val();
    var category_id = $("#category option:selected").val();*/

    var formData = new FormData();

    formData.append("name",$("#name").val());
    formData.append("date",$("#date").val());
    formData.append("address", $("#address").val());
    formData.append("description", $("#txtEditor").val());
    formData.append("organization_id", $("#organization option:selected").val());
    formData.append("category_id",$("#category option:selected").val());
    formData.append("tickets", JSON.stringify(tickets));
    formData.append("img",$("#profile-img").prop('files')[0]);

    $.ajax({
          type: "POST",
          url: "/admin/events",
          data: formData,
          processData: false,
          contentType: false,
          success: function (res) {
            alert(res.message);
          }
      });
  });
</script>
</body>
</html>